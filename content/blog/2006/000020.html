+++
mt_entry_id = 20
date = "2006-03-15T22:53:37+09:00"
title = "謎はちょっと解けた。"
categories = []

+++

ぐーたらの私です。
のび太に漫画と座布団を与えるのと同じくらい、私にモバイルノートを与えると危険です。
布団から一歩も出ませんよ。ええ。
でも、音楽だけはノートで聴いても具合がよろしくないので、デスクトップで動かしているiTunesのパーティーシャホーにまかせっきりになるわけです。

すると、ときどき困るわけですよ。
あれ、この曲なんだっけ。とか。今はこの曲を聞く気分じゃ無いぞとか。
そんな場合、わざわざ布団から出て、デスクトップの前まで5歩も歩かないといけない！
何たる不便！
折角無線lanで繋がっているのだから、ノートでリモート操作出来たら良いのにな、と考えたのが去年の秋ごろでしょうか。<!--more-->なにやら<a href="http://developer.apple.com/sdk/itunescomsdk.html">iTunesのsdk</a>とやらが出ているらしいので、落としてきて弄ってみる。
sdkに従ってcでコードを書き、comを叩いてみる。成功。
折角ネットワーク越しに弄るのだからと、perlをインストールして(この時までperlを触ったことは無かったと思う)、comを叩いてみる。成功!
いよいよ、ネットワーク越しに操作するため、apacheをインストール。
割と簡単にwebサーバーが起動し、cgiも動くようになる。
それではcgiでiTunesをコントロールッッッ。。。失敗。ナゼぇ？

どうやらcomオブジェクトの作成の段階でレスポンスが無い。
で、google先生に聞いてみると、同じ問題にぶつかっている人がいる。

<a href="http://blog.bulknews.net/mt/archives/001391.html">blog.bulknews.net :: AirTunes リモコン</a>

しかし、ここでも結局問題は解決せず。
（ちなみにこの時は、bulknewsの中の人が何者なのか知る由も無く、「なんだ野良ハッカーめ途中で投げ出しやがってこの腑抜けが」などと思ってました。・・・おそろしい。)

で、結局max/mspのexternalで実装してnetsendでコントロールしたりしてました。非常に面倒くさくしかも不安定で、殆ど使い物になりませんでしたが。

ここまでが、去年の秋ごろの話。
そして今日、突然動いてしまったんですよ。
XPPersonal + ActivePerl + Apache1.3 + iTunes6 で。

どうやらiTunes Helperという常駐ソフトが邪魔をしていたらしく、こいつを停止してからcom経由でiTunesを起動してやると上手くいきました。
詳しい追試などはまだ行っておりませんし、十分な環境を用意することも出来ないので断言は出来ませんが、同じ事で困っている人がいたらお試しください。

#20060316追記
#結構色々問題がありそうなので、手を出さないほうが良いです。
#私現在iTunes起動しません。んがー。