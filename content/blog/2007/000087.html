+++
mt_entry_id = 87
date = "2007-02-28T00:01:17+09:00"
title = "Movable Typeのエントリー投稿画面の叩き方"
categories = []

+++

案外知られていない気がしますが、MovableTypeのエントリー投稿画面を開く際のクエリには、タイトルやエントリー本文などを渡すことが出来ます。
例えば以下のようなクエリを付けてエントリー投稿画面のURLをブラウザで叩くと、本文に「hoge」と入力された状態のエントリー編集画面が開きます。

<pre class="code">http://www.example.com/cgi-bin/mt/mt.cgi?__mode=view&amp;_type=entry&amp;blog_id=1&amp;text=hoge
</pre>

これを利用することで、様々な目的に特化したブックマークレットを作成する事が出来ます。
例として、amazonの商品ページを紹介するブックマークレットを作ってみます。<!--more-->例えば、閲覧中のamazon.co.jpの商品ページを自分のMovableTypeで紹介する場合


■とりあえず動いた

<a href="
javascript:

var cgipath = 'http://www.aklaswad.com/cgi-bin/blog/mt.cgi';
var amazonId = 'blogaklaswadc-22';

function parseASIN(){
    var li=document.getElementsByTagName('li'),i=0,e,t,res;
    while(e=li[i++]){
        if((t=e.innerHTML).match(/ASIN:|ISBN-10:/)){
            res = t.replace(/^.+ (.+)$/,'$1');
        }
    }
    return res;
}

var asin = parseASIN();
var link = 'http://www.amazon.co.jp/exec/obidos/ASIN/' + asin + '/' + amazonId + '/ref=nosim/';
var img = 'http://images-jp.amazon.com/images/P/' + asin + '.09.MZZZZZZZ.jpg';
var text = '<a href=&quot;' + link + '&quot;><img src=&quot;' + img + '&quot;></a>';
void(window.open(cgipath + '?__mode=view&_type=entry&blog_id=2&text=' + text, 'hoge'));

">test</a>