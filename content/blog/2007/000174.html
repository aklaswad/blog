+++
mt_entry_id = 174
date = "2007-07-14T20:14:26+09:00"
title = "サーバーを引っ越してみた"
categories = []

+++

xreaのやや古めのサーバーから、新しいサーバーに引っ越した。
引越しのお目当てはsvn。xreaの新しいサーバーではsvnが利用可能なので、色々な作業が非常に楽になります。
リポジトリの公開が出来るかは微妙ですが、外部からのexportができるだけでもかなり嬉しいですね。

今回行った作業の手順

<ol>
	<li>新しいサーバーを確保する(ValueDomainでドメインを取得している場合、取得しているドメインの数だけXreaに無料サーバースペースを利用できる。3クリック程度で申請、一時間弱で利用可能になる。)</li>
	<li>確保したサーバーにMTをインストール、コピーしたsqliteのデータベースを読ませることでマルッと移植。</li>
	<li>でもこれだけでは画像などのデータは移植できないので、ブログディレクトリも移植。tarで固めてwget。楽。</li>
	<li>いったん新しい環境に合わせてmt-config.cgiを修正し動作確認。問題なす。</li>
	<li>mt-config.cgiを前のものに戻す。ディレクトリ構成は変えない予定。</li>
	<li>ValueDomainでDNSの設定を変更。blog.aklaswad.comドメインのAレコードを新しいサーバーに向ける。</li>
	<li>DNSレコードが浸透するまでコーヒー。</li>
	<li>新しいサーバーのXREAのコントロールパネルから、「ドメインウェブ」の設定(名前ベースのVirtualHost設定)をする。</li>
	<li>動作確認して終わり。</li>
</ol>

手順の8,では、名前がそのサーバーに対して解決できるまでは設定できない。エラーメッセージが小さいので、最初何故設定が反映されないのか分からなかったです。
よそから移動してくる場合、「強制」設定を使えばよかったのですね。
またはdefaultでメンテナンス画面が出るようにするか。

あと、途中でXREAの広告免除権の移動もしてます。一時的に広告が見えた人もいるかと思いますが、それはご愛嬌ということで。