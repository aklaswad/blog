+++
mt_entry_id = 463
date = "2010-02-18T02:24:19+09:00"
title = "77+9"
categories = []

+++

先日、とあるバグを退治しようとしていて遭遇したのがこの「77+9」という数式。
サーバから値を取得する部分が想定した動作をしないので生データを追跡したところ、やたらと「77+9」を呪文のように繰り返す文字列が浮かび上がってきた。

結論を言えば、この「77+9」は、utf-8の上限値である「0xEF0xBF0xBD」というバイト列をBase64で符号化した結果だった。
この時点では仮説に過ぎないが、utf-8特有の
このことから、Bese64でエンコードする前の段階で、文字列のutf-8への符号化の試みに失敗し、緊急避難的に上限値をという形跡が見て取れる。
正直自分はその点に気づかずに、結構な時間を無駄にしてしまったが、一度この現象を目にした事のあるエンジニアならば、問題点はBase64以前に

Encodeモジュールと格闘しているものは、麻雀牌の隙間でアルファベットが泡を吹いている映像を見れば、それはutf8-binaryが不慮の事故によって望まぬアップグレードをされた残骸だと知っている。

もうすこし考えを進めれば、結果文字列からなんか変なの出て来ちゃったという時に、その変なのを貼付ければ「ああ、これShift_JISを