+++
mt_entry_id = 375
date = "2008-01-29T00:34:13+09:00"
title = "ダイナミックパブリッシングとPHPを併用してはならぬ"
categories = []

+++

MTのPHP化(各ファイルを拡張子*.phpとして出力する手法)と、MTのデフォルトのPHPによるダイナミックパブリッシングを併用する事は、かなりリスクが高いです。

例えとして、以下のようなテンプレートを考えます。

<mt:setvar name="var1" value="print">
<?php <mt:getvar name="var1">("hello?") ?>

これは、通常のMTのテンプレートエンジンによる処理では以下のように2段階に処理されます。

<mt:setvar name="var1" value="print">
<?php <mt:getvar name="var1">("hello?") ?>
↓
(MTのテンプレートエンジンの処理:MTタグの部分だけが処理される。)
↓
<?php print("hello?") ?>
↓
(一旦ファイルとして保存された後、ページへのアクセス時に再度phpのエンジンで処理される)
↓
hello?

しかし、MTのダイナミックパブリッシングのテンプレートエンジンは、基本的にPHPの処理をそのまま流用しています。テンプレートの中に含まれているMTタグをPHPのコードに置き換えて、それをPHPコードとして実行する、そんな流れになっています。

<mt:setvar name="var1" value="print">
<?php <mt:getvar name="var1">("hello?") ?>
↓
(MTのエンジンの前処理:MTタグの部分がphpコードに置き換えられる。)
↓
<?php $var1 = "print"; ?>
<?php <?php $var1 ?>("hello?") ?>
↓
(MTのエンジンがphpとして処理する)
↓
???